# supabase-client-init: Supabase クライアント生成関数の実装

## 作成ファイル
- `src/lib/env.ts` — 環境変数取得関数（NEXT_PUBLIC_SUPABASE_URL, NEXT_PUBLIC_SUPABASE_ANON_KEY）
- `src/backend/contexts/shared/infrastructure/db/supabase-browser-client.ts` — ブラウザ用クライアント（@supabase/ssr の createBrowserClient）
- `src/backend/contexts/shared/infrastructure/db/supabase-server-client.ts` — Server Component / Server Action 用クライアント（createServerClient + cookies()）
- `src/backend/contexts/shared/infrastructure/db/supabase-middleware-client.ts` — Middleware 用クライアント（NextRequest/NextResponse の cookie 操作）
- `test/unit/lib/env.test.ts` — env.ts のユニットテスト（4 テスト）
- `test/unit/contexts/shared/infrastructure/db/supabase-browser-client.test.ts` — ブラウザクライアントのテスト
- `test/unit/contexts/shared/infrastructure/db/supabase-server-client.test.ts` — サーバークライアントのテスト（4 テスト、setAll の Server Component 例外無視も検証）
- `test/unit/contexts/shared/infrastructure/db/supabase-middleware-client.test.ts` — ミドルウェアクライアントのテスト（3 テスト）

## 設計判断
- env.ts は `src/lib/` に配置（フロントエンド側のユーティリティ層、backend 以外からも参照可能）
- 環境変数は関数で取得する形式にし、未設定時にランタイムエラーを投げる（型安全性確保）
- Server Client の setAll は try-catch で例外を握り潰す（Server Component から呼ばれた場合 cookie 書き込み不可のため、Supabase 公式パターン）
- Middleware Client は request/response 両方の cookie を同期する（Supabase SSR 公式ドキュメント準拠）

## 次のタスクへの申し送り
- 認証 middleware（middleware.ts）実装時に `createSupabaseMiddlewareClient` を利用する
- auth context の infrastructure 層から server/browser client を利用して AuthGateway を実装する
